---
prev:
    text: "环境配置"
    link: "../../#环境配置"
---

# Visual Studio 2022 的安装与配置

::: tip

1. 首先在电脑上安装“QQ·Windows 版”。
2. 本次及后续所发的所有文档，都是在电脑上打开。
3. 本次及后续所发的所有安装，都是在电脑上进行。
4. 不回答手机打开文档后所发生的一切问题。
5. 只能是 Windows 电脑，不支持 Mac 电脑/鸿蒙电脑。
    - 后期作业会用到一些 Windows 特性的东西。
    - 作业提交后用基于 Intel/AMD 的 Windows 进行正确性测试，如果用 Mac 版 Visual Studio/虚拟机/Wine 等方式测试并提交作业，需自行确保代码正确。若由于兼容性问题失分，不支持申诉。

:::

> [!NOTE]
> 由于 Visual Studio 2022 仍在不断更新，安装过程中的一些细节（如版本号）可能和本文档截图有差异，无需在意。
> 课程进行过程中，如果 VS 有版本更新，可以自行安装。
>
> 本安装文档基于“Windows 11 专业版 24H2”。若 Windows 的版本不同，后续步骤在细节上可能存在差异，通常无需在意，如果需要支持可以联系助教。
> （购买电脑通常自带 Windows 11 家庭中文版，也可以使用）
>
> ![操作系统版本](001-操作系统版本.png)
>
> [同济正版软件平台](https://software.tongji.edu.cn) 有正版的 Windows11 系统(教育/企业/专业版)供下载并激活，在籍学生可免费使用。
>
> 注意事项：
>
> 1. 需登录同济 VPN 后访问
> 2. 每 180 天需连接 KMS 服务器后激活一次
> 3. Office2021 等软件也有提供，可按需取用

**开学第一课：尊重版权就是尊重他人的劳动(也是你未来的劳动)，养成使用正版软件的习惯！！！**

::: details 目录

[[toc]]

:::

## 第 1 步：调整“Windows 控制面板”中的文件夹设置选项

::: warning
第一步非常重要，不要漏做！
:::

### 1-1：打开控制面板

鼠标右键点击任务栏“开始”图标，选择“运行”，在出现的“运行”对话框中输入“control”：

![运行](002-运行.png)

![输入control](003-打开控制面板.png)

### 1-2：在“控制面板”中选择“外观和个性化”  

![外观和个性化](004-外观和个性化.png)

### 1-3：选择“文件资源管理器选项”  

![文件资源管理器选项](005-文件资源管理器选项.png)

### 1-4：调整设置

出现的对话框中，选择“查看”卡片，去除“隐藏已知文件类型的扩展名”选项，按“确定”  

![调整选项](006-调整设置.png)

## 第 2 步：下载 Visual Studio 2022 简体中文社区版

::: tip

- **不需要**安装“企业版”、“专业版”等
- 可自行决定是否选用“英文版”（不支持不反对，如果出现字符集差异等问题，需自行解决）
- “社区版”针对个人/学生开发者免费使用
- “社区版”足够支持大学四年的编程需求
- 其它版本多出的“协同工作”等功能个人不需要

:::

> [!IMPORTANT]
>
> - **下面的安装步骤以推荐版本为准，非推荐版本后续不提供技术支持**
> - **本课程提交的作业用推荐版本编译，以推荐版本的编译及运行结果为准**

### 2-1: 打开官方网站

打开微软 [Visual Studio 官方网站](https://visualstudio.microsoft.com/zh-hans)，
选择“免费 Visual Studio”：

![官方在线安装包](007-官方在线安装包.png)

::: tip
本文档中使用 Chrome 浏览器，若使用其他浏览器，显示内容可能略有差异
:::

### 2-2: 选择正确版本

选择“Visual Studio Community”版本，按“免费下载”  

![下载](008-下载.png)

### 2-3: 找到所下载的文件

等待下载完成，点击右上角的下载文件处，选“在文件夹中显示”

![下载的文件](009-下载的文件.png)

## 第 3 步：双击 VisualStudioSetup.exe，启动安装程序

![启动安装程序](010-启动安装程序.png)

注：文件名也可能不同  

## 第 4 步：出现如下界面，选择“继续”

![继续](011-继续.png)

注：初次安装时需要从微软服务器下载准备文件，依据不同网速等待时间可能不同，注意观察进度条即可

![下载进度](012-下载进度.png)

## 第 5 步：若安装完成后，再次通过步骤 3 启动安装程序，则出现如下界面，可增减安装选项/卸载软件等

注：本界面第一次安装时不会出现！！！  

![再次打开安装程序](013-再次打开安装程序.png)

## 第 6 步：出现如下界面，选择“使用 C++ 的桌面开发”，右侧选择多项(下面界面形式即可)，按“安装”

![安装选项](014-安装选项.png)

注：本文档仅指导初学者安装C++的最基本应用环境，后续可自行按需增加

## 第 7 步：进入安装过程（耐心等待，什么也不用做）

![安装过程](015-安装过程.png)

注：1000M宽带（有线方式接入），安装大约需要15-20分钟

## 第 8 步：安装结束

![安装结束](016-安装结束.png)

## 第 9 步：安装结束后，会直接出现 VS2022 的登录界面，选择“跳过并稍后增加账户”

![跳过登录](017-跳过登录.png)

::: tip

1. 如果有Microsoft账户或者GitHub账户，可以选择登录
2. 也可以选择“创建账户”来创建一份Microsoft账户(具体方法自行研究)

:::

## 第 10 步：开发设置选“常规”即可，颜色主题根据自己的喜好自行选择，按“启动 Visual Studio”

![初次启动](018-初次启动.png)

## 第 11 步：等待登录完成，出现下面窗口后，按“继续但无需代码”

![继续但无需代码](019-无代码继续.png)

## 第 12 步：阅读相关内容（可忽略），然后关闭即可

![欢迎页](020-欢迎页.png)

## 第 13 步：出现此界面，表示启动成功

![启动成功](021-启动成功.png)

## 第 14 步：安装 FileEncoding 插件(非常重要，用于字符集的判断及切换) {#file-encoding}

### 14-1: “扩展”菜单-“管理扩展”  

![管理扩展](022-管理扩展.png)

### 14-2：扩展管理器-“浏览”-输入“FileEncoding”-找到后单击“安装”

![安装FileEncoding](023-安装FileEncoding.png)

### 14-3：出现下述提示后，选择关闭Visual Studio  

![扩展开始安装](024-扩展开始安装.png)

### 14-4：开始安装插件，选“Modify”，安装结束后选“Close”即可  

![扩展安装完成](025-扩展安装完成.png)

::: tip
如果插件安装不成功，可以直接双击打开 <a href="/Website/FileEncoding.vsix" target="_self">FileEncoding.vsix</a> 进行安装。

:::

**至此，VS2022 安装、配置完成，可以使用。**

## 附录 1：设置快速启动 Visual Studio 2022（推荐，但非必须）

方法1：开始图标 - 全部 - 找到“Visual Studio 2022” - 鼠标拖曳到桌面空白处  

![开始菜单-全部](026-开始菜单-全部.jpg)
![开始菜单-VS](027-开始菜单-VS.jpg)

方法2：VS2022启动成功后，任务栏上对应图标按鼠标右键，再选择“固定到任务栏”

![固定到任务栏](028-任务栏.jpg)

## 附录 2：其他设置项

若需要改变字体大小颜色、设置缩进格式等，则在“工具”菜单中选择“选项”，在出现的对话框进行设置，具体方法可自行研究并尝试

![工具-选项](029-工具-选项.jpg)

![VS设置项](030-VS设置项.png)

## 附录 3：改变“解决方案资源管理器”的位置

若希望改变“解决方案资源管理器”的位置，用鼠标左键按住“解决方案资源管理器”的标题栏进行拖拽，放置到指定位置即可，具体效果可自行尝试

![解决方案资源管理器位置](031-解决方案资源管理器位置.png)
